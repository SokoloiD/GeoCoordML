

</i>

### обучение модели
Для обучение модели служит программа <br>
train.py<br>
параметры запуска программы можно задать через файл train_config.yaml или через командную строку.<br>
файл конфигурации train_config.yaml<br>
<i>
defaults:<br>
  - map: kazan_cfg.yaml<br>
<br>
#путь к корневому каталогу<br>
path_to_root: ..\..\..\..\..<br>
#путь от корневого каталога до изображения карты<br>

walks_file: data\interim\walks4.txt<br>
model_save: best_model_crop32.pkl<br>
train_val_ratio: 0.8<br>
batch_size: 512<br>
crop_size: 32<br>
walk_step: 1<br>
class_cnt: 18<br>
deviation: 3<br>
epoch: 20<br>
lr: 0.001<br>
</i>
данные для обучения  - файл с маршрутом, проложенным по территории одного типа (класса). маршрут представляет собой ломанную, которая задана набором координат точек в пикселях. Не более 10 точек на одном маршруте. <br>
Для обучающей выборки вдоль маршрута выбираются изображения с размером стороны crop_size, шагом walk_step  и случайным отклонением в пределах deviation<br>

### проверка качества обучения и анализ качества разметки - 
программа sort_images.py<br>
файл конфигурации sort_images_config.yaml<br>

программа выполняет расчет количества верно и неверно классифицированных точек изображения. На вход подаются так же как и в train.py маршруты (ломанные). К ним применяются аналогичные преобразования.<br>
Результаты работы сортируются по уровню loss.<br>
Изобажения с наихудшим loss сохраняются в  debug_image_dir<br>
количество неправлильно классифицированных изображений с худшим loss     save_miclassified_images: 10<br>
количество  правлильно классифицированных изображений с худшим loss save_classified_images: 10<br>
<br>
